<% layout('layout/boilerplate') %> <%- include('../templates/sidebar') %>
<link rel="stylesheet" href="/styles/show.css" />

<main>
  <%- include('../templates/flash') %>
  <div class="middlePart">
    <nav class="searchBar">
      <form class="searchComponents" action="" method="">
        <input value="<%= keyword %>" type="text" name="q" id="" class="form-control" value="<%= keyword%>" />
        <button>Buscar</button>
      </form>
    </nav>

    <section class="postsContainer">
      <% for(let post of posts){ %> <% if(post.privacy === 'public'){ %>
      <a href="/posts/<%=post._id%>">
        <div class="post">
          <h2 id="title"><%= post.title %></h2>
          <p id="author">
            <small> <%= `@${post.author.name}` %> </small>
          </p>
          <p id="body"><%= post.body %></p>
          <p id="faculty"><%= post.faculty%> | <%= post.degree%></p>
          <p id="attachments">Archivos: <%= post.image.length %></p>
          <p id="votes">Votos: <%= post.votes.length %></p>
        </div>
      </a>
      <hr />
      <% } %> <% } %>
    </section>
  </div>
  <div class="groupContent">
    <a class="btn btn-success newGroup" href="groups/new">Crear un grupo</a>
    <div class="personalGroups">
      <p class="myGroups">Tus grupos:</p>
      <% if(myGroups.length !== 0){ %> <% for (let group of myGroups){ %>
      <a class="groupPost" href="/groups/<%= group._id %>">
        <div class="groupPostInfo">
          <p class="postName"><%= group.name %></p>
          <p class="groupData"><%= group.description %></p>
          <p class="groupData">Miembros: <%= group.members.length %></p>
          <p class="groupData">Publicaciones: <%= group.posts.length %></p>
        </div>
      </a>
      <% } %> <% }else{ %>
      <p class="groupPostInfo">Actualmente no sigues ningun grupo!</p>
      <% } %>
    </div>

    <div class="personalGroups">
      <p class="myGroups">Descubre nuevos grupos:</p>
      <% if(newGroups.length !== 0){ %> <% for (let group of newGroups){ %>
      <a class="groupPost" href="/groups/<%= group._id %>">
        <div class="groupPostInfo">
          <p class="postName"><%= group.name %></p>
          <p class="groupData"><%= group.description %></p>
          <p class="groupData">Miembros: <%= group.members.length %></p>
          <p class="groupData">Publicaciones: <%= group.posts.length %></p>
        </div>
      </a>
      <% } %><% }else{ %>
      <p class="groupPostInfo">Actualmente no hay grupos nuevos para descubrir!</p>
      <% } %>
    </div>
  </div>
</main>
